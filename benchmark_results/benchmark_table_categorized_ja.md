# Jacobi法ベンチマーク結果（カテゴリー別）

## 1. シングルスレッド（逐次処理）ベースライン

### 性能比較（中央値、単位: ms）

| 実装 | 64x64 | 128x128 | 512x512 | 1024x1024 |
|:---|---:|---:|---:|---:|
| C Single Thread | 4.76 | 13.48 | 76.22 | 270.43 |
| Rust Single Thread | 6.14 | 14.52 | 77.55 | 309.32 |

### 言語間オーバーヘッド（Rust vs C）

| グリッドサイズ | オーバーヘッド | 備考 |
|:---|---:|:---|
| 64x64 | 1.29× | 小さいグリッド、オーバーヘッドが目立つ |
| 128x128 | 1.08× | オーバーヘッド減少 |
| 512x512 | 1.02× | ほぼ同等 |
| 1024x1024 | 1.14× | 大規模でわずかなオーバーヘッド |

---

## 2. セマフォ実装

### 性能比較（中央値、単位: ms）

| 実装 | 64x64 | 128x128 | 512x512 | 1024x1024 |
|:---|---:|---:|---:|---:|
| **C Semaphore** | 3.93 | 8.12 | 37.88 | 134.55 |
| **Rust Safe Semaphore** | 4.90 | 10.45 | 43.70 | 163.19 |
| **Rust Unsafe Semaphore** | 4.83 | 8.69 | 40.66 | 144.55 |

### シングルスレッドに対する高速化率

| 実装 | 64x64 | 128x128 | 512x512 | 1024x1024 |
|:---|---:|---:|---:|---:|
| C Semaphore | 1.21× | 1.66× | 2.01× | 2.01× |
| Rust Safe Semaphore | 1.25× | 1.39× | 1.77× | 1.90× |
| Rust Unsafe Semaphore | 1.27× | 1.67× | 1.91× | 2.14× |

### 安全性のコスト（Rust Safe / Rust Unsafe）

| グリッドサイズ | Safety Cost | オーバーヘッド |
|:---|---:|---:|
| 64x64 | 1.01× | 1% |
| 128x128 | 1.20× | 20% |
| 512x512 | 1.07× | 7% |
| 1024x1024 | 1.13× | 13% |

### 言語間比較（Rust Safe / C）

| グリッドサイズ | オーバーヘッド | 分析 |
|:---|---:|:---|
| 64x64 | 1.25× | 実装戦略の違い |
| 128x128 | 1.29× | Mutexオーバーヘッドが顕著 |
| 512x512 | 1.15× | スケーリング改善 |
| 1024x1024 | 1.21× | 一貫したオーバーヘッド |

---

## 3. バリア実装

### 性能比較（中央値、単位: ms）

| 実装 | 64x64 | 128x128 | 512x512 | 1024x1024 |
|:---|---:|---:|---:|---:|
| **C Barrier** | 9.41 | 15.82 | 46.17 | 165.88 |
| **Rust Safe Barrier** | 12.77 | 18.92 | 49.66 | 174.56 |
| **Rust Unsafe Barrier** | 10.46 | 15.16 | 42.60 | 153.85 |

### シングルスレッドに対する高速化率

| 実装 | 64x64 | 128x128 | 512x512 | 1024x1024 |
|:---|---:|---:|---:|---:|
| C Barrier | 0.51× | 0.85× | 1.65× | 1.63× |
| Rust Safe Barrier | 0.48× | 0.77× | 1.56× | 1.77× |
| Rust Unsafe Barrier | 0.59× | 0.96× | 1.82× | 2.01× |

### 安全性のコスト（Rust Safe / Rust Unsafe）

| グリッドサイズ | Safety Cost | オーバーヘッド |
|:---|---:|---:|
| 64x64 | 1.22× | 22% |
| 128x128 | 1.25× | 25% |
| 512x512 | 1.17× | 17% |
| 1024x1024 | 1.13× | 13% |

### 言語間比較（Rust Safe / C）

| グリッドサイズ | オーバーヘッド | 分析 |
|:---|---:|:---|
| 64x64 | 1.36× | 小グリッドで高いオーバーヘッド |
| 128x128 | 1.20× | オーバーヘッド減少 |
| 512x512 | 1.08× | ほぼ同等の戦略 |
| 1024x1024 | 1.05× | 非常に近い性能 |

---

## 4. OpenMP / Rayon実装

### 性能比較（中央値、単位: ms）

| 実装 | 64x64 | 128x128 | 512x512 | 1024x1024 |
|:---|---:|---:|---:|---:|
| **C OpenMP** | 22.92 | 23.71 | 39.10 | 115.68 |
| **Rust Safe Rayon** | 13.50 | 19.22 | 48.00 | 173.64 |
| **Rust Unsafe Rayon** | 12.88 | 18.47 | 49.63 | 175.85 |

### シングルスレッドに対する高速化率

| 実装 | 64x64 | 128x128 | 512x512 | 1024x1024 |
|:---|---:|---:|---:|---:|
| C OpenMP | 0.21× | 0.57× | 1.95× | 2.34× |
| Rust Safe Rayon | 0.45× | 0.76× | 1.62× | 1.78× |
| Rust Unsafe Rayon | 0.48× | 0.79× | 1.56× | 1.76× |

### 安全性のコスト（Rust Safe / Rust Unsafe）

| グリッドサイズ | Safety Cost | オーバーヘッド |
|:---|---:|---:|
| 64x64 | 1.05× | 5% |
| 128x128 | 1.04× | 4% |
| 512x512 | 0.97× | -3%（Safeが速い！） |
| 1024x1024 | 0.99× | -1%（Safeが速い！） |

### 言語間比較（Rust Safe / C OpenMP）

| グリッドサイズ | Rayonの優位性 | 分析 |
|:---|---:|:---|
| 64x64 | 0.59× | Rayonが1.70×速い |
| 128x128 | 0.81× | Rayonが1.23×速い |
| 512x512 | 1.23× | OpenMPが1.23×速い |
| 1024x1024 | 1.50× | OpenMPが1.50×速い |

---

## まとめ

### グリッドサイズ別最速実装

| グリッドサイズ | 最速C実装 | 最速Rust Safe | 最速Rust Unsafe | 総合優勝 |
|:---|:---|:---|:---|:---|
| 64x64 | Semaphore (3.93ms) | Semaphore (4.90ms) | Semaphore (4.83ms) | **C Semaphore** |
| 128x128 | Semaphore (8.12ms) | Semaphore (10.45ms) | Semaphore (8.69ms) | **C Semaphore** |
| 512x512 | Semaphore (37.88ms) | OpenMP (39.10ms) | Barrier Unsafe (42.60ms) | **C Semaphore** |
| 1024x1024 | OpenMP (115.68ms) | Semaphore (163.19ms) | Semaphore (144.55ms) | **C OpenMP** |

### 主要な観察結果

1. **セマフォ**: 最も一貫した性能、特に中〜大規模グリッドで優秀
2. **バリア**: 適度なオーバーヘッド、大規模グリッドで改善
3. **OpenMP/Rayon**: 
   - 小グリッドで高いオーバーヘッド
   - 1024x1024で最良のスケーリング（C OpenMP: 2.34×高速化）
   - 小グリッドでRayonが優位、大グリッドでOpenMPが優位
4. **安全性のコスト**: 一般的に1-25%、Rayonで最小（時に負の値！）
5. **言語間オーバーヘッド**: 同等実装でRustがCより2-36%遅い
